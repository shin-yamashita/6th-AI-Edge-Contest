{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"index.html","text":"6th AI Edge Contest / TFlite delegate \u3068 rv32emc \u3092\u7528\u3044\u305f\u5b9f\u88c5 \u00b6 2023/01/28 \u3000 s.yamashita \u8ab2\u984c \u00b6 \u8eca\u4e21\u524d\u65b9\u306e\u753b\u50cf\u304a\u3088\u3073\u5168\u65b9\u4f4d\u306e\u70b9\u7fa4\u30c7\u30fc\u30bf\u304b\u3089\u30013D\u7269\u4f53\u691c\u51fa\u3092\u884c\u3046\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3092\u4f5c\u6210 \u958b\u767a\u3057\u305f\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3092\u3001RISC-V\u3092\u642d\u8f09\u3057\u305f\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u306b\u5b9f\u88c5 \u6982\u8981 \u00b6 \u4eca\u56de\u306e\u8ab2\u984c\u306b\u5bfe\u3057\u3001TensorFlow Lite(\u4ee5\u4e0bTFlite) \u306e delegate \u6a5f\u69cb\u3092\u7528\u3044\u305f FPGA \u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u3092\u958b\u767a\u3057\u305f (\u7b2c5\u56de\u30b3\u30f3\u30c6\u30b9\u30c8\u3067\u7528\u3044\u305f\u3082\u306e\u3092 out channel 4\u4e26\u5217\u5b9f\u884c\u3059\u308b\u3088\u3046\u4fee\u6b63\u3057\u3066\u7528\u3044\u305f) RISC-V \u306f rv32emc \u306b\u5bfe\u5fdc\u3059\u308b CPU core \u3092 scratch \u304b\u3089\u958b\u767a\u3057\u305f (\u7b2c5\u56de\u30b3\u30f3\u30c6\u30b9\u30c8\u3067\u7528\u3044\u305f\u3082\u306e\u306b fpu \u3092\u7d44\u307f\u8fbc\u3093\u3060\u3002fpu \u306f\u6574\u6570\u30ec\u30b8\u30b9\u30bf\u3092\u7528\u3044\u308b\u5f62\u5f0f\"Zfinx\"\u3068\u3057\u305f) \u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u306e\u5b9f\u884c\u5236\u5fa1\u3068\u3001lider data \u304b\u3089 BEV \u753b\u50cf\u3092\u751f\u6210\u3059\u308b pre \u51e6\u7406\u3092\uff11\u3064\u306e RISC-V\u3067\u884c\u3063\u305f FPGA \u3078\u306e\u5b9f\u88c5\u306f\u3001\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u3001RISC-V core \u3068\u3082 SystemVerilog \u3092\u7528\u3044\u305f RTL \u8a18\u8ff0\u3067\u884c\u3063\u305f \u63a8\u8ad6\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f Super-Fast-Accurate-3D-Object-Detection-PyTorch ^1 \u3092\u30d9\u30fc\u30b9\u306b\u5b66\u7fd2\u3092\u884c\u3044\u3001pytorch \u2192 TFlite \u5909\u63db\u306e\u5f8c 8bit \u91cf\u5b50\u5316\u3092\u884c\u3063\u305f \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f TFlite \u306e python \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3068 python C API \u3092\u7528\u3044\u3001RISC-V \u3067\u306e BEV \u753b\u50cf\u751f\u6210\u51e6\u7406\u306f C\u8a00\u8a9e\u3067\u958b\u767a\u3057\u305f \u63a8\u8ad6\u30cd\u30c3\u30c8\u30ef\u30fc\u30af \u00b6 3D\u7269\u4f53\u691c\u51fa\u306e\u30d9\u30fc\u30b9\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f Super-Fast-Accurate-3D-Object-Detection-PyTorch ^1 (SFA3D) \u3092\u9078\u629e\u3057\u305f \u8eca\u4e21\u5168\u65b9\u4f4d\u306e lider \u30c7\u30fc\u30bf\u304b\u3089 BEV \u9ce5\u77b0\u753b\u50cf\u3092\u751f\u6210\u3057\u3001fpn_resnet_18 \u3092\u7528\u3044\u305f centernet \u3067\u7269\u4f53\u4e2d\u5fc3\u5ea7\u6a19\u3092\u63a8\u8ad6\u3059\u308b \u5b66\u7fd2\u306b\u306f\u63d0\u4f9b\u3055\u308c\u305f OperaDataset \u306e\u3046\u3061\u3001\u5168\u65b9\u4f4d\u3067\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3055\u308c\u3066\u3044\u308b\u30c7\u30fc\u30bf\u306e\u307f\u7528\u3044\u3001train 90% val 10% \u306b\u5206\u3051\u3066\u5b66\u7fd2\u3057\u305f \u4eca\u56de\u306e\u8ab2\u984c\u3067\u306f\u7269\u4f53\u306e\u4e2d\u5fc3\u5ea7\u6a19\u306e\u307f\u6c42\u3081\u308b\u306e\u3067\u3001\u52d5\u4f5c\u901f\u5ea6\u306e\u89b3\u70b9\u3067\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u51fa\u529b\u3092 heatmap \u3068 center offset \u306b\u7d5e\u3063\u305f \u307e\u305f\u3001fpn_resnet_18 \u306e\u4e2d\u306e ReLU \u3092 ReLU6 \u306b\u5909\u66f4\u3057\u305f\u3068\u3053\u308d\u91cf\u5b50\u5316\u5f8c\u306e\u7cbe\u5ea6\u304c\u82e5\u5e72\u6539\u5584\u3057\u305f ^1 SFA3D \u5b66\u7fd2\u5f8c\u306e pytorch \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092 TFlite \u306b\u5909\u63db\u3057\u30018bit \u91cf\u5b50\u5316\u3092\u884c\u3063\u305f pytorch model \u3092 openvino2tensorflow ^2 \u3067 TFlite \u306b\u5909\u63db\u3057\u3001Training \u5f8c\u306e\u91cf\u5b50\u5316\u3092\u884c\u3063\u3066\u30018bit \u306b\u91cf\u5b50\u5316\u3057\u305f TFlite \u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u7de8\u96c6\u3057\u3001Pad+Conv2D(valid) \u3092 Conv2D(same) \u306b\u7f6e\u304d\u63db\u3048\u305f(\u56f31) pytorch \u2192 TFlite \u5909\u63db\u3067\u3001Conv2D \u306e\u4ed5\u69d8\u306e\u4e0d\u6574\u5408 ^3 \u304b\u3089 pytorch:Conv2D(same) -> TFlite:Pad+Conv2D(valid) \u306b\u5909\u63db\u3055\u308c\u3066\u3057\u307e\u3046(\u4f59\u5206\u306a Pad \u51e6\u7406\u304c\u767a\u751f\u3059\u308b) Conv2D \u306e stride \u8a2d\u5b9a\u304c 1 \u306e\u3068\u304d\u306f\u5358\u7d14\u306b Pad \u3092\u30d0\u30a4\u30d1\u30b9\u3057\u3001valid \u3092 same \u306b\u66f8\u304d\u63db\u3048\u308c\u3070\u3088\u3044\u304c\u3001stride \u304c 2 \u306e\u3068\u304d\u306b Conv2D \u306e\u51fa\u529b\u4f4d\u76f8\u304c\u5408\u308f\u306a\u304f\u306a\u308b\u3002stride\u304c 2 \u306e\u30ce\u30fc\u30c9\u306f FPGA \u306e\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u306e\u8a2d\u5b9a\u3092\u4fee\u6b63\u3057\u3066\u4f4d\u76f8\u3092\u5408\u308f\u305b\u308b\u3088\u3046\u306b\u3057\u305f \u56f31. pytorch \u2192 TFlite \u5909\u63db\u3067\u4f59\u5206\u306aPAD\u304c\u767a\u751f\u3059\u308b\u554f\u984c\u3068\u5bfe\u51e6 \u30d9\u30fc\u30b9\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f BEV \u753b\u50cf\u30b5\u30a4\u30ba\u304c 608x608 \u3067\u3042\u308b\u304c\u3001FPGA\u3067\u306e\u5b9f\u884c\u6642\u9593\u3068\u63a8\u8ad6\u7cbe\u5ea6\u306e\u30c8\u30ec\u30fc\u30c9\u30aa\u30d5\u3092\u53d6\u308b\u305f\u3081 320x320 \u53ca\u3073 448x448 \u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3082\u5b66\u7fd2\u3057\u305f \u56f32 \u306b BEV \u753b\u50cf\u3068 heatmap \u753b\u50cf\u306e\u4f8b (320x320) \u3092\u793a\u3059 ^2 openvino2tensorflow ^3 comparing-conv2d-with-padding-between-tensorflow-and-pytorch BEV \u306e\u5e45\u306f\u3001100m \u76f8\u5f53\u306b\u3057\u305f\u304c\u3001\u5e45 84m \u76f8\u5f53\u306b\u3057\u3066\u8eca\u4f53\u9032\u884c\u65b9\u5411\u309245\u5ea6\u50be\u3051\u305f\u30d1\u30bf\u30fc\u30f3(R45 \u56f32\u4e0b)\u3082\u8a66\u3057\u305f \u5e45 84m \u3067\u306f\u8eca\u306e\u691c\u51fa\u7bc4\u56f2 50m \u3092\u8d85\u3048\u308b\u9818\u57df\u304c\u767a\u751f\u3057\u8eca\u306e\u691c\u51fa\u3092\u53d6\u308a\u3053\u307c\u3059\u304c\u3001\u691c\u51fa\u3057\u306b\u304f\u3044\u6b69\u884c\u8005\u306e\u691c\u51fa\u7387\u3092\u4e0a\u3052\u308b\u52b9\u679c\u304c\u3042\u308b \u307e\u305f\u3001\u8eca\u4f53\u659c\u308145\u5ea6\u65b9\u5411\u306e\u8eca\u306e\u51fa\u73fe\u983b\u5ea6\u306f\u8eca\u4f53\u6b63\u9762\u3088\u308a\u5c11\u306a\u3044\u69d8\u3067\u3042\u308a\u3001\u5b9f\u7528\u7684\u306b\u3082\u8eca\u4f53\u6b63\u9762\u304c\u91cd\u8981\u3067\u3042\u308b\u306e\u3067\u6b63\u9762\u306e\u691c\u51fa\u7bc4\u56f2\u3092\u5e83\u3052\u308b\u306e\u304c\u826f\u3044\u3068\u8003\u3048\u305f \u56f32.BEV \u753b\u50cf\u3068 heatmap \u753b\u50cf \u56f33 \u306f BEV \u306e\u753b\u50cf\u30b5\u30a4\u30ba(S/M/L : 320/448/608)\u3068\u300145\u5ea6\u50be\u3051\u305f\u30d1\u30bf\u30fc\u30f3(R45) \u306b\u3088\u308b Average Precision \u306e\u5909\u5316\u3067\u3042\u308b \u8a08\u6e2c\u306f\u3001KV-260 \u4e0a\u3067\u5b9f\u884c\u3057\u305f\u3002\u7528\u3044\u305f\u30c7\u30fc\u30bf\u306f\u5b66\u7fd2\u6642\u306b val \u7528\u306b\u5206\u3051\u305f\u30c7\u30fc\u30bf\u3067\u3042\u308b train \u3068 val \u306e\u30c7\u30fc\u30bf\u306f\u4f3c\u901a\u3063\u3066\u3044\u308b\u306e\u3067 AP \u304c\u9ad8\u3081\u306b\u51fa\u3066\u3044\u308b\u3002(\u30ea\u30fc\u30c0\u30fc\u30dc\u30fc\u30c9\u3067\u306f\u30b5\u30a4\u30ba 608 \u3067 mAP = 0.32 \u3067\u3042\u308a\u5927\u304d\u306a\u4e56\u96e2\u304c\u3042\u308b) \u307e\u305f\u3001FPGA \u3067\u5b9f\u884c\u3057\u305f AP \u306f CPU \u3067\u5b9f\u884c\u3057\u305f AP \u3088\u308a\u82e5\u5e72(~4%\u7a0b\u5ea6)\u4f4e\u3044\u3002\u6574\u6570\u6f14\u7b97\u3067\u3042\u308b\u304c\u3001Acc \u306e\u4e38\u3081\u51e6\u7406\u306b\u82e5\u5e72\u5dee\u304c\u3042\u308a\u3053\u308c\u304c\u8981\u56e0\u306e\u53ef\u80fd\u6027\u304c\u3042\u308b BEV \u753b\u50cf\u30b5\u30a4\u30ba\u304c\u5c0f\u3055\u304f\u306a\u308b\u3068\u3001\u7279\u306b\u6b69\u884c\u8005\u306e\u691c\u51fa\u7387\u304c\u9855\u8457\u306b\u4f4e\u4e0b\u3059\u308b R45 \u3067\u306f BEV \u753b\u50cf\u30b5\u30a4\u30ba\u304c\u5c0f\u3055\u3044\u3068\u304d\u306e\u6b69\u884c\u8005\u306e\u691c\u51fa\u7387\u304c\u4e0a\u304c\u3063\u3066\u304a\u308a\u3001\u52b9\u679c\u304c\u8a8d\u3081\u3089\u308c\u308b \u56f33.BEV \u753b\u50cf\u30b5\u30a4\u30ba\u3068 R45 \u306b\u3088\u308b Average Precision \u306e\u6bd4\u8f03 \u4ee5\u4e0b\u306f\u3001TFlite \u306e benchmark tool \u3092 KV-260 \u306e CPU(aarch64) \u4e0a\u3067\u5b9f\u884c\u3057\u3001\u4eca\u56de\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af(608x608)\u3092\u5206\u6790\u3057\u305f\u7d50\u679c\u3067\u3042\u308b\u3002 CPU \u3067\u306e\u63a8\u8ad6\u5b9f\u884c\u6642\u9593\u306f\u7d04 7.55 s \u3067\u3042\u308a\u3001Conv2D \u306e\u6f14\u7b97\u3067 96.2% \u3092\u5360\u3081\u308b\u3002Conv2D \u6f14\u7b97\u3092 FPGA \u306bdelegate \u3059\u308b Number of nodes executed: 79 ============================ Summary by node type =========== [Node type] [count] [avg ms] [avg %] [cdf %] CONV_2D 35 7264.019 96.151% 96.151% RESIZE_BILINEAR 3 121.071 1.603% 97.754% ADD 8 45.425 0.601% 98.355% SUM 2 44.592 0.590% 98.945% QUANTIZE 11 25.896 0.343% 99.288% CONCATENATION 5 22.259 0.295% 99.583% MAX_POOL_2D 1 15.889 0.210% 99.793% SOFTMAX 2 11.255 0.149% 99.942% RESIZE_NEAREST_NEIGHBOR 2 2.091 0.028% 99.969% MUL 2 1.682 0.022% 99.992% DEQUANTIZE 2 0.441 0.006% 99.998% RESHAPE 6 0.182 0.002% 100.000% total 7554.84 ms \u5168\u4f53\u30b7\u30b9\u30c6\u30e0\u69cb\u6210 \u00b6 \u56f34 \u306b\u30b7\u30b9\u30c6\u30e0\u69cb\u6210\u3092\u793a\u3059\u3002 TFlite \u306e Interpreter\uff08\u63a8\u8ad6\u30d7\u30ed\u30b0\u30e9\u30e0\uff09\u306b\u306f\u5916\u90e8\u306e\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u3092\u63a5\u7d9a\u3059\u308b delegate API \u304c\u3042\u308a ^4 \u3001\u3053\u308c\u3092\u7528\u3044\u3066 FPGA \u306b\u6f14\u7b97\u3092\u59d4\u8b72\u3059\u308b\u3002 ^4 implementing_delegate \u56f34.\u30b7\u30b9\u30c6\u30e0\u69cb\u6210 \u65b0\u305f\u306b\u4f5c\u6210\u3057\u305fFPGA\u3068\u306e\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u95a2\u6570 dummy_external_delegate.so \u3092 Interpreter \u306b\u30ea\u30f3\u30af\u3059\u308b\u3002 \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u95a2\u6570\u306f\u8d77\u52d5\u6642\u306bdelegate \u3059\u308b\u6f14\u7b97\u7a2e\u5225 Conv2D, depthwiseConv2D \u306e\uff12\u3064\u3092\u767b\u9332\u3059\u308b\u3002(\u4eca\u56de\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u306f depthwise \u306f\u4f7f\u308f\u308c\u3066\u3044\u306a\u3044\u304c\u3001\u56de\u8def\u898f\u6a21\u306f\u5909\u308f\u3089\u306a\u3044\u306e\u3067\u6b8b\u3057\u3066\u3042\u308b) Interpreter \u3092\u8d77\u52d5\u3059\u308b\u3068\u3001FlatBuffer \u5f62\u5f0f\u306e graph \u3092\u5b9f\u884c\u3057\u3001\u767b\u9332\u3057\u305f\u6f14\u7b97\u306e\u307f\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u95a2\u6570\u306b\u6e21\u3055\u308c\u308b\u3002 \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u95a2\u6570\u306b\u306f Conv \u6f14\u7b97\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3068\u3001input, filter, bias, output \u306e\uff14\u3064\u306e Tensor \u3078\u306e\u30dd\u30a4\u30f3\u30bf\u30fc\u304c\u6e21\u3055\u308c\u308b\u306e\u3067\u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u3068\u30dd\u30a4\u30f3\u30bf\u30fc\u3092 FPGA \u306b\u6e21\u3057\u3066 \u30cf\u30fc\u30c9\u30a6\u30a7\u30a2\u306e\u30b7\u30fc\u30b1\u30f3\u30b5\u30fc\u3092 kick \u3057\u3001\u6f14\u7b97\u7d42\u4e86\u3092\u5f85\u3064\u3002 Tensor \u3078\u306e\u30dd\u30a4\u30f3\u30bf\u30fc\u306f\u3001Linux \u306e\u4eee\u60f3\u8a18\u61b6\u9818\u57df\u306b\u3042\u308a\u3001\u76f4\u63a5FPGA\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3067\u304d\u306a\u3044\u3002 Interpreter\u8d77\u52d5\u6642\u3001\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u95a2\u6570\u306e Prepare() \u304c\u4e00\u5ea6\u3060\u3051\u547c\u3070\u308c\u308b\u306e\u3067\u3001\u3053\u306e\u4e2d\u3067\u4e88\u3081 Tensor\u30c7\u30fc\u30bf\u3092 CMA \u9818\u57df\u306b copy \u3057\u3066\u304a\u304d\u3001\u3053\u306e\u9818\u57df\u3067 FPGA \u3068\u30c7\u30fc\u30bf\u3092\u3084\u308a\u53d6\u308a\u3059\u308b\u3002 \u307e\u305f\u3001output channel \u3054\u3068\u306e\u91cf\u5b50\u5316\u30d1\u30e9\u30e1\u30fc\u30bf quant \u3092\u8a08\u7b97\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u3001\u4e00\u5ea6\u3060\u3051\u8a08\u7b97\u3057\u3066 CMA \u9818\u57df\u306b\u4fdd\u6301\u3059\u308b\u3002 \u4eca\u56de\u306f\u3001\u7b2c\uff15\u56de\u30b3\u30f3\u30c6\u30b9\u30c8\u3067\u7528\u3044\u305f\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u306b\u3001output channel \u3092 4\u4e26\u5217\u3067\u51e6\u7406\u3059\u308b\u3088\u3046\u306b\u5909\u66f4\u3092\u884c\u3063\u305f\u304c\u3001\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u306e Conv filter \u4fc2\u6570\u306e\u30a2\u30af\u30bb\u30b9\u9806\u5e8f\u304c\u9023\u7d9a\u3059\u308b\u3088\u3046\u306b filter \u4fc2\u6570\u306e\u4e26\u3079\u66ff\u3048\u3092\u884c\u3063\u305f\u3002\u3053\u306e\u4e26\u3079\u304b\u3048\u3082 Prepare() \u3067\u884c\u3063\u305f\u3002\u3000 FPGA \u306b\u6e21\u3057\u305f Conv\u6f14\u7b97\u30d1\u30e9\u30e1\u30fc\u30bf\u306f\u3001FPGA \u5074\u306b\u8a2d\u3051\u305f RISC-V CPU \u3067\u4e26\u5217\u6f14\u7b97\u306b\u5bfe\u5fdc\u3057\u305f\u5f62\u306b\u5909\u63db\u3057\u3066 Conv\u6f14\u7b97\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u306e\u30b7\u30fc\u30b1\u30f3\u30b5\u306b\u4e0e\u3048\u3001kick \u3059\u308b\u3002 FPGA \u306e CPU \u306f\u3001\u30b7\u30fc\u30b1\u30f3\u30b5\u306e\u7d42\u4e86\u3092\u5f85\u3063\u3066\u3001output buffer \u306b\u6b8b\u3063\u305f\u30c7\u30fc\u30bf\u3092 CMA \u9818\u57df\u306b flush \u3057\u3066\u6f14\u7b97\u3092\u7d42\u4e86\u3057\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u901a\u77e5\u3059\u308b\u3002 \u4ee5\u4e0a\u304c Interpreter \u3068 FPGA \u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u30fc\u304c\u9023\u643a\u3057\u3066\u63a8\u8ad6\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u6f14\u7b97\u3092\u884c\u3046\u6d41\u308c\u3067\u3042\u308b\u3002 \u4eca\u56de\u306e\u8ab2\u984c\u3067\u306f\u3001 lider data \u3092 BEV \u753b\u50cf\u306b\u5909\u63db\u3059\u308b pre \u51e6\u7406\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u51fa\u529b\u3067\u3042\u308b heatmap \u304b\u3089\u7269\u4f53\u4f4d\u7f6e\u3092\u8a08\u7b97\u3059\u308b post \u51e6\u7406\u304c\u5fc5\u8981\u3067\u3042\u308b\u3002 \u3053\u308c\u3089\u306e\u51e6\u7406\u306e\u3046\u3061\u3001\u3088\u308a\u591a\u304f\u306e\u6f14\u7b97\u51e6\u7406\u306e\u5fc5\u8981\u306a pre \u51e6\u7406\u3092\u3001RISC-V \u3067\u5b9f\u884c\u3057\u305f\u3002\u66f4\u306b\u3001pre \u51e6\u7406\u3068 Interpreter \u306e\u63a8\u8ad6\u51e6\u7406\u3092\u4e26\u884c\u3057\u3066\u5b9f\u884c\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u3066\u5b9f\u884c\u6642\u9593\u306e\u5897\u5927\u3092\u6291\u3048\u305f\u3002 \u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u30fc\u306e\u5236\u5fa1\u306f RISC-V \u306e\u5272\u308a\u8fbc\u307f\u51e6\u7406\u3067\u884c\u3063\u3066\u304a\u308a\u3001pre \u51e6\u7406\u3068\u5e73\u884c\u306b\u5b9f\u884c\u3055\u308c\u308b\u3002 rv32emc core \u306e\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2 \u00b6 \u7b2c5\u56de\u30b3\u30f3\u30c6\u30b9\u30c8\u3067\u7528\u3044\u305f RISC-V \u30b3\u30a2\u306f\u3001SystemVerilog \u3067 scratch \u304b\u3089\u8a18\u8ff0\u3057\u305f\u3082\u306e\u3067\u3042\u308b\u3002 RISC-V \u306e ISA \u306e\u3046\u3061\u3001\u7d44\u307f\u8fbc\u307f\u7528\u9014\u5411\u3051\u306e EMC (32bit 16 Register, Mul/Div, Compressed \u547d\u4ee4) \u306e\u69cb\u6210\u3067\u958b\u767a\u3057\u305f\u3002 ^5 \u4eca\u56de\u3053\u306e CPU core \u306b fpu \u3092\u8ffd\u52a0\u3057\u305f\u3002 fp \u30ec\u30b8\u30b9\u30bf\u3092\u8a2d\u3051\u305a\u306b\u3001\u6574\u6570\u30ec\u30b8\u30b9\u30bf\u3092\u5171\u7528\u3059\u308b Zfinx \u4ed5\u69d8 ^6 \u3068\u3057\u3066\u30cf\u30fc\u30c9\u898f\u6a21\u3092\u6291\u3048\u305f\u3002\u305f\u3060\u3057\u3001fmadd/fmsub \u547d\u4ee4\u306f\uff13\u30aa\u30da\u30e9\u30f3\u30c9\u547d\u4ee4\u3067\u8ffd\u52a0\u306b\u3088\u308b\u5909\u66f4\u898f\u6a21\u304c\u5927\u304d\u304f\u3001\u5b9f\u88c5\u3057\u306a\u304b\u3063\u305f\u3002 \u30af\u30ed\u30b9\u30b3\u30f3\u30d1\u30a4\u30e9\u306f riscv-gnu-toolchain \u3067 Zfinx \u306b\u5bfe\u5fdc\u3057\u305f\u3082\u306e ^7 (gcc \u30d0\u30fc\u30b8\u30e7\u30f3\u306f 10.2.0) \u306b\u6539\u9020\u3092\u52a0\u3048 fmadd/fmsub \u3092\u4f7f\u308f\u306a\u3044\u3088\u3046\u306b\u3059\u308b\u4fee\u6b63\u3092\u884c\u3063\u3066\u3044\u308b\u3002 [^7]\u306b\u3057\u305f\u304c\u3063\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb zfinx/riscv-gcc/gcc/config/riscv/riscv.md \u3092\u4fee\u6b63\u2192fmadd/fmsub\u3092\u751f\u6210\u3059\u308b\u6761\u4ef6\u3092disable $ ./configure --prefix=/opt/rv32e/ --with-abi=ilp32e --with-arch=rv32emczfinx --with-multilib-generator='rv32emczfinx-ilp32e--' $ make newlib ^5 github shin-yamashita/rv32emc ^6 Zfinx+TG riscv.org ^7 risc-v gcc for Zfinx (How-to-regression-test) FPGA\u306b\u5b9f\u88c5\u3057\u305f\u30cf\u30fc\u30c9\u30a6\u30a8\u30a2\u69cb\u6210 \u00b6 \u56f35\u306b FPGA PL \u90e8\u306b\u5b9f\u88c5\u3057\u305f\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u306e\u30d6\u30ed\u30c3\u30af\u69cb\u6210\u3092\u793a\u3059\u3002 \u7b2c5\u56de\u30b3\u30f3\u30c6\u30b9\u30c8\u3067\u7528\u3044\u305f\u56de\u8def\u3092 output channel 4 \u4e26\u5217\u51e6\u7406\u3067\u304d\u308b\u3088\u3046\u306b\u4fee\u6b63\u3057\u3001\u5236\u5fa1\u53ca\u3073 lider data \u30d7\u30ec\u51e6\u7406\u7528 CPU \u3068\u3057\u3066\u524d\u8ff0\u306e rv32emc CPU \u3092\u7528\u3044\u305f\u3002 \u307e\u305f\u3001CPU \u3068\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u306e\u30af\u30ed\u30c3\u30af\u3092\u5206\u96e2\u3057\u3001\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u304c\u975e\u540c\u671f\u3067\u3067\u304d\u308b\u3088\u3046\u306b\u6539\u4fee\u3057\u305f\u306e\u3067\u3001CPU \u3068\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u306e\u30af\u30ed\u30c3\u30af\u5468\u6ce2\u6570\u3092\u72ec\u7acb\u3057\u3066\u8a2d\u5b9a\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3002 PS \u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f\u3001AXI-APB bridge \u3092\u4ecb\u3057\u3066RISC-V \u306e RAM \u3092\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002 RISC-V \u306e\u5b9f\u884c\u30d0\u30a4\u30ca\u30ea\u3092 RAM \u306b\u30ed\u30fc\u30c9\u3057\u3001reset \u3092\u89e3\u9664\u3059\u308b\u3053\u3068\u3067 CPU \u3092\u8d77\u52d5\u3059\u308b\u3002 \u307e\u305f\u3001APB \u304b\u3089 \u5272\u308a\u8fbc\u307f\u3092\u767a\u751f\u3057\u3001\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u306e\u5236\u5fa1\u3092 kick \u3059\u308b\u3002 \u56f35. PL \u30d6\u30ed\u30c3\u30af\u56f3 Accelerator \u90e8\u3067\u306f\u3001Tensor data \u306e\u30a2\u30c9\u30ec\u30b9\u3092\u767a\u751f\u3059\u308b adrgen \u304b\u3089\u306e\u30a2\u30c9\u30ec\u30b9\u306b\u3057\u305f\u304c\u3063\u3066 Tensor data \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3002 \u7573\u307f\u8fbc\u307f\u6f14\u7b97\u56de\u8def(MAC)\u3067 input tensor \u3068 filter tensor \u3092\u4e57\u7b97\u3001\u7d2f\u7b97\u3057\u3001bias \u3092\u52a0\u3048\u305f\u306e\u30618bit\u306b\u91cf\u5b50\u5316\u3057\u3001output tensor \u306b\u51fa\u529b\u3059\u308b\u3002 Conv2D \u3068 dwConv2D \u306e\uff12\u7a2e\u306e\u6f14\u7b97\u3067 MAC \u56de\u8def\u306f\u5171\u901a\u3067\u3042\u308a\u3001\u30a2\u30c9\u30ec\u30b9\u767a\u751f\u30d1\u30bf\u30fc\u30f3\u304c\u7570\u306a\u308b\u306e\u307f\u3067\u3042\u308b\u3002 input, filter, bias, quant, output \u306e5\u3064\u306e\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u306f\u3001S_AXI_HPC0_FPD \u30dd\u30fc\u30c8\u3092\u4ecb\u3057\u3066 PS \u306e CMA \u9818\u57df\u3092\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3002 \u3053\u308c\u3089\u306e\u30c7\u30fc\u30bf\u306f\u3001output channel \uff14\u4e26\u5217\u5358\u4f4d\u3067\u30a2\u30af\u30bb\u30b9\u3055\u308c\u308b\u3002 MAC \u306f\u3001Np(x4) \u500b\u4e26\u5217\u306b\u5b9f\u88c5\u3055\u308c\u3066\u304a\u308a\u3001input, output \u306e\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u306b\u306f Np \u500b\u4e26\u5217\u306b\u30ad\u30e3\u30c3\u30b7\u30e5\u30e1\u30e2\u30ea\u3092\u8a2d\u3051\u305f\u3002filter, bias, quant \u306f\u5168\u3066\u306e MAC \u6f14\u7b97\u3067\u5171\u901a\u306a\u306e\u3067\u3001\u305d\u308c\u305e\u308c\uff11\u500b\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u30e1\u30e2\u30ea\u3092\u8a2d\u3051\u305f\u3002 filter, bias, quant, output \u306f\u9023\u7d9a\u30a2\u30af\u30bb\u30b9\u306a\u306e\u3067\u3001FIFO\u30d0\u30c3\u30d5\u30a1\u306e\u3088\u3046\u306a\u69cb\u9020\u3067\u826f\u3044\u304c\u3001input \u306f\u7573\u307f\u8fbc\u307f\u306e\u30bf\u30c3\u30d7\u3067\u5927\u304d\u304f\u30a2\u30c9\u30ec\u30b9\u304c\u98db\u3076\u306e\u3067\u300116\u30e9\u30a4\u30f3\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u30e1\u30e2\u30ea\u69cb\u9020\u306b\u3057\u305f\u3002(\u56f36.input-cache \u30d6\u30ed\u30c3\u30af\u56f3 \u53c2\u7167\uff09 \u56f36. input-cache \u30d6\u30ed\u30c3\u30af\u56f3 \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 \u56f37. Np \u5206\u5272 \u4e26\u5217\u5316\u306e\u30a2\u30c9\u30ec\u30b9\u5206\u5272\u306f\u3001\u56f37\u306b\u793a\u3059\u3088\u3046\u306b\u3001output Tensor \u306e W x H \u3092 Np \u5206\u5272\u3059\u308b\u3002C \u3092\u5171\u901a\u306b\u3059\u308b\u3053\u3068\u3067\u3001filter, bias, quant \u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u304c\uff11\u7cfb\u7d71\u3067\u3059\u3080\u3002 \u305f\u3060\u3057\u3001W x H < Np \u306e\u3068\u304d\u306f\u4e26\u5217\u6570\u306f W x H \u306b\u5236\u9650\u3055\u308c\u308b\u3002 \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u95a2\u6570\u304b\u3089\u6e21\u3055\u308c\u308b\u6f14\u7b97\u30d1\u30e9\u30e1\u30fc\u30bf\u306f\u3001M_AXI_HPM0_FPD \u30dd\u30fc\u30c8 axi-apb \u30d6\u30ea\u30c3\u30b8\u3092\u4ecb\u3057\u3001\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u5236\u5fa1\u7528 RISC-V CPU \u306b\u6e21\u3055\u308c\u308b\u3002 Np\u500b\u4e26\u5217\u306e input/output \u305d\u308c\u305e\u308c\u306b\u7570\u306a\u308b\u30a2\u30c9\u30ec\u30b9\u767a\u751f\u3092\u884c\u3046\u305f\u3081\u3001CPU \u306f adrgen \u30d6\u30ed\u30c3\u30af\u306b Np\u7a2e\u985e\u306e\u30a2\u30c9\u30ec\u30b9\u3092\u8a08\u7b97\u3057\u3001\u8a2d\u5b9a\u3092\u884c\u3046\u3002 \u4e26\u5217\u306b\u5b9f\u88c5\u3059\u308b\u30a2\u30c9\u30ec\u30b9\u767a\u751f\u56de\u8def\u3092\u3067\u304d\u308b\u3060\u3051\u7c21\u5358\u5316\u3057\u3066\u30cf\u30fc\u30c9\u898f\u6a21\u3092\u6291\u3048\u308b\u305f\u3081\u306b\u3001CPU \u306b\u30a2\u30c9\u30ec\u30b9\u8a08\u7b97\u3092\u5206\u62c5\u3059\u308b\u3088\u3046\u306b\u3057\u305f\u3002\u307e\u305f\u3001\u3053\u306e CPU \u306b\u306f\u30b7\u30ea\u30a2\u30eb\u30bf\u30fc\u30df\u30ca\u30eb\u3092\u63a5\u7d9a\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u3001\u30c7\u30d0\u30c3\u30b0\u304a\u3088\u3073\u5b9f\u884c\u6642\u9593\u306e\u89b3\u6e2c\u306a\u3069\u306b\u3082\u6d3b\u7528\u3057\u305f\u3002 \u8ad6\u7406\u5408\u6210\u3001FPGA \u5b9f\u88c5 \u00b6 \u4f5c\u6210\u3057\u305f RTL module \u3092 Vivado \u306e Block Design \u30c4\u30fc\u30eb\u306b\u8aad\u307f\u8fbc\u3093\u3067 Zynq \u3068\u63a5\u7d9a\u3057\u305f\u3002 (\u56f38. Block Design\u3000\u8272\u4ed8\u304d\u306e\u30d6\u30ed\u30c3\u30af\u304cRTL\u30d6\u30ed\u30c3\u30af) Np \u3001\u30ad\u30e3\u30c3\u30b7\u30e5\u30b5\u30a4\u30ba\u3001\u30af\u30ed\u30c3\u30af\u5468\u6ce2\u6570\u306a\u3069\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u5909\u3048\u3066\u8ad6\u7406\u5408\u6210\u3092\u7e70\u308a\u8fd4\u3057\u3001\u30a8\u30ea\u30a2\u53ca\u3073\u30bf\u30a4\u30df\u30f3\u30b0\u304c MET \u3067\u304d\u308b\u3088\u3046\u306b RTL \u8a18\u8ff0\u306b\u30d5\u30a3\u30fc\u30c9\u30d0\u30c3\u30af\u3057\u305f\u3002 \u56f38. Block Design \u56f39 \u306f\u6700\u7d42\u7684\u306a FPGA \u306e\u30ea\u30bd\u30fc\u30b9\u4f7f\u7528\u7387\u3067\u3042\u308b\u3002 \u3000 \u4e26\u5217\u6570 Np = 32 (MAC 128 \u4e26\u5217) \u3000 \u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u30af\u30ed\u30c3\u30af\u5468\u6ce2\u6570 = 187 MHz \u3000 RISC-V \u30af\u30ed\u30c3\u30af\u5468\u6ce2\u6570 = 100MHz BRAM \u304c 100% \u8fd1\u304f\u306b\u306a\u3063\u3066\u304a\u308a\u3001\u3053\u308c\u4ee5\u4e0a\u306e\u4e26\u5217\u6570\u5897\u52a0\u306f\u96e3\u3057\u3044\u3002\u307e\u305f\u4f7f\u7528\u7387\u304c\u4e0a\u304c\u308b\u306b\u5f93\u3063\u3066\u30bf\u30a4\u30df\u30f3\u30b0\u304c\u53b3\u3057\u304f\u306a\u308a\u3001\u30af\u30ed\u30c3\u30af\u5468\u6ce2\u6570\u3092\u4e0a\u3052\u3089\u308c\u306a\u3044\u3002 \u4e00\u65b9\u3067 LUT / DSP \u306b\u306f\u307e\u3060\u4f59\u88d5\u304c\u3042\u308a\u3001FPGA\u30ea\u30bd\u30fc\u30b9\u3092\u6700\u5927\u9650\u306b\u6d3b\u7528\u3059\u308b\u306b\u306f\u69cb\u9020\u306e\u898b\u76f4\u3057\u304c\u5fc5\u8981\u3067\u3042\u308b\u3002 \u56f39. Utilization \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3 \u00b6 \u4eca\u56de\u3001\u63a8\u8ad6\u306e\u5b9f\u884c\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f python \u3067\u4f5c\u6210\u3057\u305f\u3002 \u30e9\u30a4\u30d6\u30e9\u30ea tflite_runtime ^8 \u3092\u7528\u3044\u308b\u3002(KV260 \u7528\u306b tensorflow \u306e\u30bd\u30fc\u30b9\u30c4\u30ea\u30fc\u3067 cross build \u3059\u308b\u5fc5\u8981\u304c\u3042\u3063\u305f) \u65b0\u305f\u306b\u4f5c\u6210\u3057\u305f delegate \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306f\u3001\u30c0\u30a4\u30ca\u30df\u30c3\u30af\u30ea\u30f3\u30af\u30e9\u30a4\u30d6\u30e9\u30ea(dummy_external_delegate.so)\u3068\u3057\u3066 tflite_runtime \u3068\u30ea\u30f3\u30af\u3059\u308b\u3053\u3068\u3067\u5b9f\u884c\u306e delegate \u304c\u884c\u308f\u308c\u308b\u3002 tflite_runtime \u306e python \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3067\u306f interpreter \u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u6642\u306b dummy_external_delegate.so \u3092\u6307\u5b9a\u3057\u3066\u30ea\u30f3\u30af\u3059\u308b\u3060\u3051\u3067\u3042\u308b\u3002 ^8 tflite_runtime import tflite_runtime.interpreter as tflite # Instantiate interpreter interpreter = tflite . Interpreter ( model_path = model , experimental_delegates = [ tflite . load_delegate ( \u3000\u3000\u3000\u3000\u3000\u3000\u3000 '{path-to}/dummy_external_delegate.so.1' )] ) interpreter . allocate_tensors () # Get input and output tensors. input_details = interpreter . get_input_details () output_details = interpreter . get_output_details () : # preproc bev_image = preproc . preproc ( frame ) # lider data -> BEV image # set image interpreter . set_tensor ( input_details [ 0 ][ 'index' ], np . uint8 ( bev_image )) # Invoke interpreter . invoke () # Output inference result heatmap = interpreter . get_tensor ( output_details [ 0 ][ 'index' ])[ 0 ] cen_offset = interpreter . get_tensor ( output_details [ 1 ][ 'index' ])[ 0 ] # postproc det = postproc . postproc ( heatmap , cen_offset ) : RISC-V \u3068\u63a8\u8ad6\u5b9f\u884c\u30a2\u30d7\u30ea\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u3002 \u00b6 \u4ee5\u4e0b\u3001\u63a8\u8ad6\u5b9f\u884c\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u3067\u3042\u308b lider data \u3092 file \u304b\u3089\u8aad\u307f\u8fbc\u307f\u3001python C API \u3092\u4ecb\u3057\u3066 preproc module \u306b\u6e21\u3059 preproc module \u306f lider data \u3092 CMA \u9818\u57df\u306b\u30b3\u30d4\u30fc\u3057\u3001RISC-V \u3092 kick \u3059\u308b RISC-V \u306f lider data \u304b\u3089 BEV \u753b\u50cf\u3078\u306e\u5909\u63db\u51e6\u7406\u3092\u884c\u3046 1 frame \u524d\u306e preproc \u3067\u751f\u6210\u3055\u308c\u305f BEV \u753b\u50cf\u3092 TFlite interpreter \u306b set_tensor() \u3057\u3066 invoke() \u3059\u308b \u63a8\u8ad6\u7d50\u679c\u306e heatmap \u3068 center-offset \u304b\u3089\u7269\u4f53\u4f4d\u7f6e\u3092\u8a08\u7b97\u3057\u3001json \u306b\u51fa\u529b\u3059\u308b \u51e6\u7406 3. \u3068\u51e6\u7406 4. \u304c\u4e26\u5217\u306b\u884c\u308f\u308c\u308b\u3002 RISC-V \u3067\u306f\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u306e\u5236\u5fa1\u306f\u5272\u308a\u8fbc\u307f\u51e6\u7406\u306b\u3088\u3063\u3066\u884c\u308f\u308c\u3001preproc \u306e BEV\u753b\u50cf\u751f\u6210\u51e6\u7406\u3068\u4e26\u5217\u306b\u5b9f\u884c\u3055\u308c\u308b\u3002 \u56f310. \u63a8\u8ad6\u5b9f\u884c\u30a2\u30d7\u30ea\u30b7\u30fc\u30b1\u30f3\u30b9 \u5b9f\u884c\u7d50\u679c \u00b6 \u63a8\u8ad6\u51e6\u7406\u6642\u9593\u8a73\u7d30 \u00b6 \u63a8\u8ad6\u6642\u9593\u306f\u3001PS \u306e CPU \u3068 FPGA/RISC-V \u3067\u5206\u62c5\u3055\u308c\u3066\u304a\u308a\u3001FPGA\u306e\u5b9f\u884c\u6642\u9593\u306f FPGA\u5185\u306b\u5b9f\u88c5\u3057\u305f\u30ab\u30a6\u30f3\u30bf\u3067\u6e2c\u5b9a\u3057\u305f\u3002 \u56f311 \u306b\u7d50\u679c\u3092\u793a\u3059\u3002 \u56f311. \u63a8\u8ad6\u51e6\u7406\u6642\u9593 \u30b0\u30e9\u30d5\u306e Conv(\u9ec4\u8272) \u90e8\u5206\u3001\u7573\u307f\u8fbc\u307f\u6f14\u7b97\u305d\u306e\u3082\u306e\u306e\u5b9f\u884c\u6642\u9593\u304c\u652f\u914d\u7684\u3067\u3042\u308b\u3002 RISC-V \u306e preproc \u306f\u4e26\u884c\u3057\u3066\u51e6\u7406\u3055\u308c\u3001\u8868\u306b\u306f\u73fe\u308c\u306a\u3044\u3002 \u307e\u3068\u3081\u3001\u4eca\u5f8c\u306e\u8ab2\u984c \u00b6 TensorFlow Lite \u306e delegate \u6a5f\u69cb\u3092\u7528\u3044\u305f FPGA \u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u3092\u958b\u767a\u3057\u3001\u8ab2\u984c\u306b\u5bfe\u3059\u308b\u52d5\u4f5c\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u305f\u3002 \u3053\u306e\u65b9\u5f0f\u306f\u3001\u65e2\u5b58\u306e TFlite \u306e\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3092\u5909\u3048\u308b\u3053\u3068\u306a\u304f\u3001\u305d\u306e\u307e\u307e\u4f7f\u3048\u308b\u7279\u5fb4\u304c\u3042\u308b\u3002 \u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u306f output \u30c1\u30e3\u30f3\u30cd\u30eb\u306e 4\u4e26\u5217\u5316\u3092\u5b9f\u88c5\u3057\u3001MAC\u306e\u4e26\u5217\u6570\u3092 128 \u4e26\u5217\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u305f\u3002 \u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u3067 filter \u4fc2\u6570\u306e\u4e26\u3079\u66ff\u3048\u3092\u884c\u3046\u3053\u3068\u3067\u30cf\u30fc\u30c9\u30a6\u30a8\u30a2\u306e\u8907\u96d1\u5316\u3092\u56de\u907f\u3057\u305f\u3002 RISC-V (rv32emc) \u3092 RTL \u3067\u5b9f\u88c5\u3057\u3001FPGA\u306b\u7d44\u307f\u8fbc\u3093\u3067\u3001\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u5236\u5fa1\u3068 Lider \u30c7\u30fc\u30bf\u306e\u524d\u51e6\u7406\u306b\u7528\u3044\u305f\u3002 Zfinx \u4ed5\u69d8\u306e fpu \u3092\u65b0\u305f\u306b\u958b\u767a\u3057\u3066\u7d44\u307f\u8fbc\u307f\u3001Lider data \u306e\u51e6\u7406\u306b\u6d3b\u7528\u3057\u305f\u3002 \u4eca\u5f8c\u306e\u8ab2\u984c \u00b6 CPU\u3067\u306e\u63a8\u8ad6\u5b9f\u884c\u306b\u5bfe\u3057\u3001FPGA \u3067\u306e\u5b9f\u884c\u3067\u63a8\u8ad6\u7cbe\u5ea6\u304c\u82e5\u5e72\u4f4e\u4e0b\u3059\u308b\u3053\u3068\u304c\u308f\u304b\u3063\u3066\u3044\u308b\u3002 acc \u56de\u8def\u306e\u4e38\u3081\u306b\u3064\u3044\u3066\u8a73\u7d30\u306b\u8abf\u67fb\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002 \u52d5\u4f5c\u901f\u5ea6\u306f CPU 100MHz\u3001\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf 187MHz \u304c\u9650\u754c\u3067\u3042\u3063\u305f\u3002\u30af\u30ea\u30c1\u30ab\u30eb\u30d1\u30b9\u3092\u8abf\u67fb\u3057\u3001\u8ad6\u7406\u6bb5\u6570\u3092\u6e1b\u3089\u3059\u5fc5\u8981\u304c\u3042\u308b\u3002 \u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u306f pipeline \u5316\u306e\u4f59\u5730\u304c\u3042\u308b\u3002CPU \u306f compress \u547d\u4ee4\u5bfe\u5fdc\u304c\u901f\u5ea6\u4f4e\u4e0b\u306e\u4e00\u56e0\u3067\u3042\u308b\u306e\u3067\u4ed5\u69d8\u5909\u66f4\u304c\u6709\u52b9\u304b\u3082\u3057\u308c\u306a\u3044\u3002 \u3053\u308c\u307e\u3067\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u306b delegate \u3059\u308b\u6f14\u7b97\u3092 Conv2D \u306b\u9650\u3063\u3066\u304d\u305f\u304c\u3001\u30cf\u30fc\u30c9\u898f\u6a21\u306e\u5897\u5927\u3092\u6291\u3048\u3064\u3064\u5bfe\u5fdc\u3067\u304d\u308b\u6f14\u7b97\u3092\u5897\u3084\u3059\u3053\u3068\u3092\u8003\u3048\u3066\u307f\u305f\u3044\u3002","title":"6th AI Edge Contest / TFlite delegate \u3068 rv32emc \u3092\u7528\u3044\u305f\u5b9f\u88c5"},{"location":"index.html#6th-ai-edge-contest-tflite-delegate-rv32emc","text":"2023/01/28 \u3000 s.yamashita","title":"6th AI Edge Contest / TFlite delegate \u3068 rv32emc \u3092\u7528\u3044\u305f\u5b9f\u88c5"},{"location":"index.html#_1","text":"\u8eca\u4e21\u524d\u65b9\u306e\u753b\u50cf\u304a\u3088\u3073\u5168\u65b9\u4f4d\u306e\u70b9\u7fa4\u30c7\u30fc\u30bf\u304b\u3089\u30013D\u7269\u4f53\u691c\u51fa\u3092\u884c\u3046\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3092\u4f5c\u6210 \u958b\u767a\u3057\u305f\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3092\u3001RISC-V\u3092\u642d\u8f09\u3057\u305f\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u306b\u5b9f\u88c5","title":"\u8ab2\u984c"},{"location":"index.html#_2","text":"\u4eca\u56de\u306e\u8ab2\u984c\u306b\u5bfe\u3057\u3001TensorFlow Lite(\u4ee5\u4e0bTFlite) \u306e delegate \u6a5f\u69cb\u3092\u7528\u3044\u305f FPGA \u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u3092\u958b\u767a\u3057\u305f (\u7b2c5\u56de\u30b3\u30f3\u30c6\u30b9\u30c8\u3067\u7528\u3044\u305f\u3082\u306e\u3092 out channel 4\u4e26\u5217\u5b9f\u884c\u3059\u308b\u3088\u3046\u4fee\u6b63\u3057\u3066\u7528\u3044\u305f) RISC-V \u306f rv32emc \u306b\u5bfe\u5fdc\u3059\u308b CPU core \u3092 scratch \u304b\u3089\u958b\u767a\u3057\u305f (\u7b2c5\u56de\u30b3\u30f3\u30c6\u30b9\u30c8\u3067\u7528\u3044\u305f\u3082\u306e\u306b fpu \u3092\u7d44\u307f\u8fbc\u3093\u3060\u3002fpu \u306f\u6574\u6570\u30ec\u30b8\u30b9\u30bf\u3092\u7528\u3044\u308b\u5f62\u5f0f\"Zfinx\"\u3068\u3057\u305f) \u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u306e\u5b9f\u884c\u5236\u5fa1\u3068\u3001lider data \u304b\u3089 BEV \u753b\u50cf\u3092\u751f\u6210\u3059\u308b pre \u51e6\u7406\u3092\uff11\u3064\u306e RISC-V\u3067\u884c\u3063\u305f FPGA \u3078\u306e\u5b9f\u88c5\u306f\u3001\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u3001RISC-V core \u3068\u3082 SystemVerilog \u3092\u7528\u3044\u305f RTL \u8a18\u8ff0\u3067\u884c\u3063\u305f \u63a8\u8ad6\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f Super-Fast-Accurate-3D-Object-Detection-PyTorch ^1 \u3092\u30d9\u30fc\u30b9\u306b\u5b66\u7fd2\u3092\u884c\u3044\u3001pytorch \u2192 TFlite \u5909\u63db\u306e\u5f8c 8bit \u91cf\u5b50\u5316\u3092\u884c\u3063\u305f \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f TFlite \u306e python \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3068 python C API \u3092\u7528\u3044\u3001RISC-V \u3067\u306e BEV \u753b\u50cf\u751f\u6210\u51e6\u7406\u306f C\u8a00\u8a9e\u3067\u958b\u767a\u3057\u305f","title":"\u6982\u8981"},{"location":"index.html#_3","text":"3D\u7269\u4f53\u691c\u51fa\u306e\u30d9\u30fc\u30b9\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f Super-Fast-Accurate-3D-Object-Detection-PyTorch ^1 (SFA3D) \u3092\u9078\u629e\u3057\u305f \u8eca\u4e21\u5168\u65b9\u4f4d\u306e lider \u30c7\u30fc\u30bf\u304b\u3089 BEV \u9ce5\u77b0\u753b\u50cf\u3092\u751f\u6210\u3057\u3001fpn_resnet_18 \u3092\u7528\u3044\u305f centernet \u3067\u7269\u4f53\u4e2d\u5fc3\u5ea7\u6a19\u3092\u63a8\u8ad6\u3059\u308b \u5b66\u7fd2\u306b\u306f\u63d0\u4f9b\u3055\u308c\u305f OperaDataset \u306e\u3046\u3061\u3001\u5168\u65b9\u4f4d\u3067\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3055\u308c\u3066\u3044\u308b\u30c7\u30fc\u30bf\u306e\u307f\u7528\u3044\u3001train 90% val 10% \u306b\u5206\u3051\u3066\u5b66\u7fd2\u3057\u305f \u4eca\u56de\u306e\u8ab2\u984c\u3067\u306f\u7269\u4f53\u306e\u4e2d\u5fc3\u5ea7\u6a19\u306e\u307f\u6c42\u3081\u308b\u306e\u3067\u3001\u52d5\u4f5c\u901f\u5ea6\u306e\u89b3\u70b9\u3067\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u51fa\u529b\u3092 heatmap \u3068 center offset \u306b\u7d5e\u3063\u305f \u307e\u305f\u3001fpn_resnet_18 \u306e\u4e2d\u306e ReLU \u3092 ReLU6 \u306b\u5909\u66f4\u3057\u305f\u3068\u3053\u308d\u91cf\u5b50\u5316\u5f8c\u306e\u7cbe\u5ea6\u304c\u82e5\u5e72\u6539\u5584\u3057\u305f ^1 SFA3D \u5b66\u7fd2\u5f8c\u306e pytorch \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092 TFlite \u306b\u5909\u63db\u3057\u30018bit \u91cf\u5b50\u5316\u3092\u884c\u3063\u305f pytorch model \u3092 openvino2tensorflow ^2 \u3067 TFlite \u306b\u5909\u63db\u3057\u3001Training \u5f8c\u306e\u91cf\u5b50\u5316\u3092\u884c\u3063\u3066\u30018bit \u306b\u91cf\u5b50\u5316\u3057\u305f TFlite \u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u7de8\u96c6\u3057\u3001Pad+Conv2D(valid) \u3092 Conv2D(same) \u306b\u7f6e\u304d\u63db\u3048\u305f(\u56f31) pytorch \u2192 TFlite \u5909\u63db\u3067\u3001Conv2D \u306e\u4ed5\u69d8\u306e\u4e0d\u6574\u5408 ^3 \u304b\u3089 pytorch:Conv2D(same) -> TFlite:Pad+Conv2D(valid) \u306b\u5909\u63db\u3055\u308c\u3066\u3057\u307e\u3046(\u4f59\u5206\u306a Pad \u51e6\u7406\u304c\u767a\u751f\u3059\u308b) Conv2D \u306e stride \u8a2d\u5b9a\u304c 1 \u306e\u3068\u304d\u306f\u5358\u7d14\u306b Pad \u3092\u30d0\u30a4\u30d1\u30b9\u3057\u3001valid \u3092 same \u306b\u66f8\u304d\u63db\u3048\u308c\u3070\u3088\u3044\u304c\u3001stride \u304c 2 \u306e\u3068\u304d\u306b Conv2D \u306e\u51fa\u529b\u4f4d\u76f8\u304c\u5408\u308f\u306a\u304f\u306a\u308b\u3002stride\u304c 2 \u306e\u30ce\u30fc\u30c9\u306f FPGA \u306e\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u306e\u8a2d\u5b9a\u3092\u4fee\u6b63\u3057\u3066\u4f4d\u76f8\u3092\u5408\u308f\u305b\u308b\u3088\u3046\u306b\u3057\u305f \u56f31. pytorch \u2192 TFlite \u5909\u63db\u3067\u4f59\u5206\u306aPAD\u304c\u767a\u751f\u3059\u308b\u554f\u984c\u3068\u5bfe\u51e6 \u30d9\u30fc\u30b9\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f BEV \u753b\u50cf\u30b5\u30a4\u30ba\u304c 608x608 \u3067\u3042\u308b\u304c\u3001FPGA\u3067\u306e\u5b9f\u884c\u6642\u9593\u3068\u63a8\u8ad6\u7cbe\u5ea6\u306e\u30c8\u30ec\u30fc\u30c9\u30aa\u30d5\u3092\u53d6\u308b\u305f\u3081 320x320 \u53ca\u3073 448x448 \u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3082\u5b66\u7fd2\u3057\u305f \u56f32 \u306b BEV \u753b\u50cf\u3068 heatmap \u753b\u50cf\u306e\u4f8b (320x320) \u3092\u793a\u3059 ^2 openvino2tensorflow ^3 comparing-conv2d-with-padding-between-tensorflow-and-pytorch BEV \u306e\u5e45\u306f\u3001100m \u76f8\u5f53\u306b\u3057\u305f\u304c\u3001\u5e45 84m \u76f8\u5f53\u306b\u3057\u3066\u8eca\u4f53\u9032\u884c\u65b9\u5411\u309245\u5ea6\u50be\u3051\u305f\u30d1\u30bf\u30fc\u30f3(R45 \u56f32\u4e0b)\u3082\u8a66\u3057\u305f \u5e45 84m \u3067\u306f\u8eca\u306e\u691c\u51fa\u7bc4\u56f2 50m \u3092\u8d85\u3048\u308b\u9818\u57df\u304c\u767a\u751f\u3057\u8eca\u306e\u691c\u51fa\u3092\u53d6\u308a\u3053\u307c\u3059\u304c\u3001\u691c\u51fa\u3057\u306b\u304f\u3044\u6b69\u884c\u8005\u306e\u691c\u51fa\u7387\u3092\u4e0a\u3052\u308b\u52b9\u679c\u304c\u3042\u308b \u307e\u305f\u3001\u8eca\u4f53\u659c\u308145\u5ea6\u65b9\u5411\u306e\u8eca\u306e\u51fa\u73fe\u983b\u5ea6\u306f\u8eca\u4f53\u6b63\u9762\u3088\u308a\u5c11\u306a\u3044\u69d8\u3067\u3042\u308a\u3001\u5b9f\u7528\u7684\u306b\u3082\u8eca\u4f53\u6b63\u9762\u304c\u91cd\u8981\u3067\u3042\u308b\u306e\u3067\u6b63\u9762\u306e\u691c\u51fa\u7bc4\u56f2\u3092\u5e83\u3052\u308b\u306e\u304c\u826f\u3044\u3068\u8003\u3048\u305f \u56f32.BEV \u753b\u50cf\u3068 heatmap \u753b\u50cf \u56f33 \u306f BEV \u306e\u753b\u50cf\u30b5\u30a4\u30ba(S/M/L : 320/448/608)\u3068\u300145\u5ea6\u50be\u3051\u305f\u30d1\u30bf\u30fc\u30f3(R45) \u306b\u3088\u308b Average Precision \u306e\u5909\u5316\u3067\u3042\u308b \u8a08\u6e2c\u306f\u3001KV-260 \u4e0a\u3067\u5b9f\u884c\u3057\u305f\u3002\u7528\u3044\u305f\u30c7\u30fc\u30bf\u306f\u5b66\u7fd2\u6642\u306b val \u7528\u306b\u5206\u3051\u305f\u30c7\u30fc\u30bf\u3067\u3042\u308b train \u3068 val \u306e\u30c7\u30fc\u30bf\u306f\u4f3c\u901a\u3063\u3066\u3044\u308b\u306e\u3067 AP \u304c\u9ad8\u3081\u306b\u51fa\u3066\u3044\u308b\u3002(\u30ea\u30fc\u30c0\u30fc\u30dc\u30fc\u30c9\u3067\u306f\u30b5\u30a4\u30ba 608 \u3067 mAP = 0.32 \u3067\u3042\u308a\u5927\u304d\u306a\u4e56\u96e2\u304c\u3042\u308b) \u307e\u305f\u3001FPGA \u3067\u5b9f\u884c\u3057\u305f AP \u306f CPU \u3067\u5b9f\u884c\u3057\u305f AP \u3088\u308a\u82e5\u5e72(~4%\u7a0b\u5ea6)\u4f4e\u3044\u3002\u6574\u6570\u6f14\u7b97\u3067\u3042\u308b\u304c\u3001Acc \u306e\u4e38\u3081\u51e6\u7406\u306b\u82e5\u5e72\u5dee\u304c\u3042\u308a\u3053\u308c\u304c\u8981\u56e0\u306e\u53ef\u80fd\u6027\u304c\u3042\u308b BEV \u753b\u50cf\u30b5\u30a4\u30ba\u304c\u5c0f\u3055\u304f\u306a\u308b\u3068\u3001\u7279\u306b\u6b69\u884c\u8005\u306e\u691c\u51fa\u7387\u304c\u9855\u8457\u306b\u4f4e\u4e0b\u3059\u308b R45 \u3067\u306f BEV \u753b\u50cf\u30b5\u30a4\u30ba\u304c\u5c0f\u3055\u3044\u3068\u304d\u306e\u6b69\u884c\u8005\u306e\u691c\u51fa\u7387\u304c\u4e0a\u304c\u3063\u3066\u304a\u308a\u3001\u52b9\u679c\u304c\u8a8d\u3081\u3089\u308c\u308b \u56f33.BEV \u753b\u50cf\u30b5\u30a4\u30ba\u3068 R45 \u306b\u3088\u308b Average Precision \u306e\u6bd4\u8f03 \u4ee5\u4e0b\u306f\u3001TFlite \u306e benchmark tool \u3092 KV-260 \u306e CPU(aarch64) \u4e0a\u3067\u5b9f\u884c\u3057\u3001\u4eca\u56de\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af(608x608)\u3092\u5206\u6790\u3057\u305f\u7d50\u679c\u3067\u3042\u308b\u3002 CPU \u3067\u306e\u63a8\u8ad6\u5b9f\u884c\u6642\u9593\u306f\u7d04 7.55 s \u3067\u3042\u308a\u3001Conv2D \u306e\u6f14\u7b97\u3067 96.2% \u3092\u5360\u3081\u308b\u3002Conv2D \u6f14\u7b97\u3092 FPGA \u306bdelegate \u3059\u308b Number of nodes executed: 79 ============================ Summary by node type =========== [Node type] [count] [avg ms] [avg %] [cdf %] CONV_2D 35 7264.019 96.151% 96.151% RESIZE_BILINEAR 3 121.071 1.603% 97.754% ADD 8 45.425 0.601% 98.355% SUM 2 44.592 0.590% 98.945% QUANTIZE 11 25.896 0.343% 99.288% CONCATENATION 5 22.259 0.295% 99.583% MAX_POOL_2D 1 15.889 0.210% 99.793% SOFTMAX 2 11.255 0.149% 99.942% RESIZE_NEAREST_NEIGHBOR 2 2.091 0.028% 99.969% MUL 2 1.682 0.022% 99.992% DEQUANTIZE 2 0.441 0.006% 99.998% RESHAPE 6 0.182 0.002% 100.000% total 7554.84 ms","title":"\u63a8\u8ad6\u30cd\u30c3\u30c8\u30ef\u30fc\u30af"},{"location":"index.html#_4","text":"\u56f34 \u306b\u30b7\u30b9\u30c6\u30e0\u69cb\u6210\u3092\u793a\u3059\u3002 TFlite \u306e Interpreter\uff08\u63a8\u8ad6\u30d7\u30ed\u30b0\u30e9\u30e0\uff09\u306b\u306f\u5916\u90e8\u306e\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u3092\u63a5\u7d9a\u3059\u308b delegate API \u304c\u3042\u308a ^4 \u3001\u3053\u308c\u3092\u7528\u3044\u3066 FPGA \u306b\u6f14\u7b97\u3092\u59d4\u8b72\u3059\u308b\u3002 ^4 implementing_delegate \u56f34.\u30b7\u30b9\u30c6\u30e0\u69cb\u6210 \u65b0\u305f\u306b\u4f5c\u6210\u3057\u305fFPGA\u3068\u306e\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u95a2\u6570 dummy_external_delegate.so \u3092 Interpreter \u306b\u30ea\u30f3\u30af\u3059\u308b\u3002 \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u95a2\u6570\u306f\u8d77\u52d5\u6642\u306bdelegate \u3059\u308b\u6f14\u7b97\u7a2e\u5225 Conv2D, depthwiseConv2D \u306e\uff12\u3064\u3092\u767b\u9332\u3059\u308b\u3002(\u4eca\u56de\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u306f depthwise \u306f\u4f7f\u308f\u308c\u3066\u3044\u306a\u3044\u304c\u3001\u56de\u8def\u898f\u6a21\u306f\u5909\u308f\u3089\u306a\u3044\u306e\u3067\u6b8b\u3057\u3066\u3042\u308b) Interpreter \u3092\u8d77\u52d5\u3059\u308b\u3068\u3001FlatBuffer \u5f62\u5f0f\u306e graph \u3092\u5b9f\u884c\u3057\u3001\u767b\u9332\u3057\u305f\u6f14\u7b97\u306e\u307f\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u95a2\u6570\u306b\u6e21\u3055\u308c\u308b\u3002 \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u95a2\u6570\u306b\u306f Conv \u6f14\u7b97\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3068\u3001input, filter, bias, output \u306e\uff14\u3064\u306e Tensor \u3078\u306e\u30dd\u30a4\u30f3\u30bf\u30fc\u304c\u6e21\u3055\u308c\u308b\u306e\u3067\u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u3068\u30dd\u30a4\u30f3\u30bf\u30fc\u3092 FPGA \u306b\u6e21\u3057\u3066 \u30cf\u30fc\u30c9\u30a6\u30a7\u30a2\u306e\u30b7\u30fc\u30b1\u30f3\u30b5\u30fc\u3092 kick \u3057\u3001\u6f14\u7b97\u7d42\u4e86\u3092\u5f85\u3064\u3002 Tensor \u3078\u306e\u30dd\u30a4\u30f3\u30bf\u30fc\u306f\u3001Linux \u306e\u4eee\u60f3\u8a18\u61b6\u9818\u57df\u306b\u3042\u308a\u3001\u76f4\u63a5FPGA\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3067\u304d\u306a\u3044\u3002 Interpreter\u8d77\u52d5\u6642\u3001\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u95a2\u6570\u306e Prepare() \u304c\u4e00\u5ea6\u3060\u3051\u547c\u3070\u308c\u308b\u306e\u3067\u3001\u3053\u306e\u4e2d\u3067\u4e88\u3081 Tensor\u30c7\u30fc\u30bf\u3092 CMA \u9818\u57df\u306b copy \u3057\u3066\u304a\u304d\u3001\u3053\u306e\u9818\u57df\u3067 FPGA \u3068\u30c7\u30fc\u30bf\u3092\u3084\u308a\u53d6\u308a\u3059\u308b\u3002 \u307e\u305f\u3001output channel \u3054\u3068\u306e\u91cf\u5b50\u5316\u30d1\u30e9\u30e1\u30fc\u30bf quant \u3092\u8a08\u7b97\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u3001\u4e00\u5ea6\u3060\u3051\u8a08\u7b97\u3057\u3066 CMA \u9818\u57df\u306b\u4fdd\u6301\u3059\u308b\u3002 \u4eca\u56de\u306f\u3001\u7b2c\uff15\u56de\u30b3\u30f3\u30c6\u30b9\u30c8\u3067\u7528\u3044\u305f\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u306b\u3001output channel \u3092 4\u4e26\u5217\u3067\u51e6\u7406\u3059\u308b\u3088\u3046\u306b\u5909\u66f4\u3092\u884c\u3063\u305f\u304c\u3001\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u306e Conv filter \u4fc2\u6570\u306e\u30a2\u30af\u30bb\u30b9\u9806\u5e8f\u304c\u9023\u7d9a\u3059\u308b\u3088\u3046\u306b filter \u4fc2\u6570\u306e\u4e26\u3079\u66ff\u3048\u3092\u884c\u3063\u305f\u3002\u3053\u306e\u4e26\u3079\u304b\u3048\u3082 Prepare() \u3067\u884c\u3063\u305f\u3002\u3000 FPGA \u306b\u6e21\u3057\u305f Conv\u6f14\u7b97\u30d1\u30e9\u30e1\u30fc\u30bf\u306f\u3001FPGA \u5074\u306b\u8a2d\u3051\u305f RISC-V CPU \u3067\u4e26\u5217\u6f14\u7b97\u306b\u5bfe\u5fdc\u3057\u305f\u5f62\u306b\u5909\u63db\u3057\u3066 Conv\u6f14\u7b97\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u306e\u30b7\u30fc\u30b1\u30f3\u30b5\u306b\u4e0e\u3048\u3001kick \u3059\u308b\u3002 FPGA \u306e CPU \u306f\u3001\u30b7\u30fc\u30b1\u30f3\u30b5\u306e\u7d42\u4e86\u3092\u5f85\u3063\u3066\u3001output buffer \u306b\u6b8b\u3063\u305f\u30c7\u30fc\u30bf\u3092 CMA \u9818\u57df\u306b flush \u3057\u3066\u6f14\u7b97\u3092\u7d42\u4e86\u3057\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u901a\u77e5\u3059\u308b\u3002 \u4ee5\u4e0a\u304c Interpreter \u3068 FPGA \u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u30fc\u304c\u9023\u643a\u3057\u3066\u63a8\u8ad6\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u6f14\u7b97\u3092\u884c\u3046\u6d41\u308c\u3067\u3042\u308b\u3002 \u4eca\u56de\u306e\u8ab2\u984c\u3067\u306f\u3001 lider data \u3092 BEV \u753b\u50cf\u306b\u5909\u63db\u3059\u308b pre \u51e6\u7406\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u51fa\u529b\u3067\u3042\u308b heatmap \u304b\u3089\u7269\u4f53\u4f4d\u7f6e\u3092\u8a08\u7b97\u3059\u308b post \u51e6\u7406\u304c\u5fc5\u8981\u3067\u3042\u308b\u3002 \u3053\u308c\u3089\u306e\u51e6\u7406\u306e\u3046\u3061\u3001\u3088\u308a\u591a\u304f\u306e\u6f14\u7b97\u51e6\u7406\u306e\u5fc5\u8981\u306a pre \u51e6\u7406\u3092\u3001RISC-V \u3067\u5b9f\u884c\u3057\u305f\u3002\u66f4\u306b\u3001pre \u51e6\u7406\u3068 Interpreter \u306e\u63a8\u8ad6\u51e6\u7406\u3092\u4e26\u884c\u3057\u3066\u5b9f\u884c\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u3066\u5b9f\u884c\u6642\u9593\u306e\u5897\u5927\u3092\u6291\u3048\u305f\u3002 \u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u30fc\u306e\u5236\u5fa1\u306f RISC-V \u306e\u5272\u308a\u8fbc\u307f\u51e6\u7406\u3067\u884c\u3063\u3066\u304a\u308a\u3001pre \u51e6\u7406\u3068\u5e73\u884c\u306b\u5b9f\u884c\u3055\u308c\u308b\u3002","title":"\u5168\u4f53\u30b7\u30b9\u30c6\u30e0\u69cb\u6210"},{"location":"index.html#rv32emc-core","text":"\u7b2c5\u56de\u30b3\u30f3\u30c6\u30b9\u30c8\u3067\u7528\u3044\u305f RISC-V \u30b3\u30a2\u306f\u3001SystemVerilog \u3067 scratch \u304b\u3089\u8a18\u8ff0\u3057\u305f\u3082\u306e\u3067\u3042\u308b\u3002 RISC-V \u306e ISA \u306e\u3046\u3061\u3001\u7d44\u307f\u8fbc\u307f\u7528\u9014\u5411\u3051\u306e EMC (32bit 16 Register, Mul/Div, Compressed \u547d\u4ee4) \u306e\u69cb\u6210\u3067\u958b\u767a\u3057\u305f\u3002 ^5 \u4eca\u56de\u3053\u306e CPU core \u306b fpu \u3092\u8ffd\u52a0\u3057\u305f\u3002 fp \u30ec\u30b8\u30b9\u30bf\u3092\u8a2d\u3051\u305a\u306b\u3001\u6574\u6570\u30ec\u30b8\u30b9\u30bf\u3092\u5171\u7528\u3059\u308b Zfinx \u4ed5\u69d8 ^6 \u3068\u3057\u3066\u30cf\u30fc\u30c9\u898f\u6a21\u3092\u6291\u3048\u305f\u3002\u305f\u3060\u3057\u3001fmadd/fmsub \u547d\u4ee4\u306f\uff13\u30aa\u30da\u30e9\u30f3\u30c9\u547d\u4ee4\u3067\u8ffd\u52a0\u306b\u3088\u308b\u5909\u66f4\u898f\u6a21\u304c\u5927\u304d\u304f\u3001\u5b9f\u88c5\u3057\u306a\u304b\u3063\u305f\u3002 \u30af\u30ed\u30b9\u30b3\u30f3\u30d1\u30a4\u30e9\u306f riscv-gnu-toolchain \u3067 Zfinx \u306b\u5bfe\u5fdc\u3057\u305f\u3082\u306e ^7 (gcc \u30d0\u30fc\u30b8\u30e7\u30f3\u306f 10.2.0) \u306b\u6539\u9020\u3092\u52a0\u3048 fmadd/fmsub \u3092\u4f7f\u308f\u306a\u3044\u3088\u3046\u306b\u3059\u308b\u4fee\u6b63\u3092\u884c\u3063\u3066\u3044\u308b\u3002 [^7]\u306b\u3057\u305f\u304c\u3063\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb zfinx/riscv-gcc/gcc/config/riscv/riscv.md \u3092\u4fee\u6b63\u2192fmadd/fmsub\u3092\u751f\u6210\u3059\u308b\u6761\u4ef6\u3092disable $ ./configure --prefix=/opt/rv32e/ --with-abi=ilp32e --with-arch=rv32emczfinx --with-multilib-generator='rv32emczfinx-ilp32e--' $ make newlib ^5 github shin-yamashita/rv32emc ^6 Zfinx+TG riscv.org ^7 risc-v gcc for Zfinx (How-to-regression-test)","title":"rv32emc core \u306e\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2"},{"location":"index.html#fpga","text":"\u56f35\u306b FPGA PL \u90e8\u306b\u5b9f\u88c5\u3057\u305f\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u306e\u30d6\u30ed\u30c3\u30af\u69cb\u6210\u3092\u793a\u3059\u3002 \u7b2c5\u56de\u30b3\u30f3\u30c6\u30b9\u30c8\u3067\u7528\u3044\u305f\u56de\u8def\u3092 output channel 4 \u4e26\u5217\u51e6\u7406\u3067\u304d\u308b\u3088\u3046\u306b\u4fee\u6b63\u3057\u3001\u5236\u5fa1\u53ca\u3073 lider data \u30d7\u30ec\u51e6\u7406\u7528 CPU \u3068\u3057\u3066\u524d\u8ff0\u306e rv32emc CPU \u3092\u7528\u3044\u305f\u3002 \u307e\u305f\u3001CPU \u3068\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u306e\u30af\u30ed\u30c3\u30af\u3092\u5206\u96e2\u3057\u3001\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u304c\u975e\u540c\u671f\u3067\u3067\u304d\u308b\u3088\u3046\u306b\u6539\u4fee\u3057\u305f\u306e\u3067\u3001CPU \u3068\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u306e\u30af\u30ed\u30c3\u30af\u5468\u6ce2\u6570\u3092\u72ec\u7acb\u3057\u3066\u8a2d\u5b9a\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3002 PS \u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f\u3001AXI-APB bridge \u3092\u4ecb\u3057\u3066RISC-V \u306e RAM \u3092\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002 RISC-V \u306e\u5b9f\u884c\u30d0\u30a4\u30ca\u30ea\u3092 RAM \u306b\u30ed\u30fc\u30c9\u3057\u3001reset \u3092\u89e3\u9664\u3059\u308b\u3053\u3068\u3067 CPU \u3092\u8d77\u52d5\u3059\u308b\u3002 \u307e\u305f\u3001APB \u304b\u3089 \u5272\u308a\u8fbc\u307f\u3092\u767a\u751f\u3057\u3001\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u306e\u5236\u5fa1\u3092 kick \u3059\u308b\u3002 \u56f35. PL \u30d6\u30ed\u30c3\u30af\u56f3 Accelerator \u90e8\u3067\u306f\u3001Tensor data \u306e\u30a2\u30c9\u30ec\u30b9\u3092\u767a\u751f\u3059\u308b adrgen \u304b\u3089\u306e\u30a2\u30c9\u30ec\u30b9\u306b\u3057\u305f\u304c\u3063\u3066 Tensor data \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3002 \u7573\u307f\u8fbc\u307f\u6f14\u7b97\u56de\u8def(MAC)\u3067 input tensor \u3068 filter tensor \u3092\u4e57\u7b97\u3001\u7d2f\u7b97\u3057\u3001bias \u3092\u52a0\u3048\u305f\u306e\u30618bit\u306b\u91cf\u5b50\u5316\u3057\u3001output tensor \u306b\u51fa\u529b\u3059\u308b\u3002 Conv2D \u3068 dwConv2D \u306e\uff12\u7a2e\u306e\u6f14\u7b97\u3067 MAC \u56de\u8def\u306f\u5171\u901a\u3067\u3042\u308a\u3001\u30a2\u30c9\u30ec\u30b9\u767a\u751f\u30d1\u30bf\u30fc\u30f3\u304c\u7570\u306a\u308b\u306e\u307f\u3067\u3042\u308b\u3002 input, filter, bias, quant, output \u306e5\u3064\u306e\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u306f\u3001S_AXI_HPC0_FPD \u30dd\u30fc\u30c8\u3092\u4ecb\u3057\u3066 PS \u306e CMA \u9818\u57df\u3092\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3002 \u3053\u308c\u3089\u306e\u30c7\u30fc\u30bf\u306f\u3001output channel \uff14\u4e26\u5217\u5358\u4f4d\u3067\u30a2\u30af\u30bb\u30b9\u3055\u308c\u308b\u3002 MAC \u306f\u3001Np(x4) \u500b\u4e26\u5217\u306b\u5b9f\u88c5\u3055\u308c\u3066\u304a\u308a\u3001input, output \u306e\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u306b\u306f Np \u500b\u4e26\u5217\u306b\u30ad\u30e3\u30c3\u30b7\u30e5\u30e1\u30e2\u30ea\u3092\u8a2d\u3051\u305f\u3002filter, bias, quant \u306f\u5168\u3066\u306e MAC \u6f14\u7b97\u3067\u5171\u901a\u306a\u306e\u3067\u3001\u305d\u308c\u305e\u308c\uff11\u500b\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u30e1\u30e2\u30ea\u3092\u8a2d\u3051\u305f\u3002 filter, bias, quant, output \u306f\u9023\u7d9a\u30a2\u30af\u30bb\u30b9\u306a\u306e\u3067\u3001FIFO\u30d0\u30c3\u30d5\u30a1\u306e\u3088\u3046\u306a\u69cb\u9020\u3067\u826f\u3044\u304c\u3001input \u306f\u7573\u307f\u8fbc\u307f\u306e\u30bf\u30c3\u30d7\u3067\u5927\u304d\u304f\u30a2\u30c9\u30ec\u30b9\u304c\u98db\u3076\u306e\u3067\u300116\u30e9\u30a4\u30f3\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u30e1\u30e2\u30ea\u69cb\u9020\u306b\u3057\u305f\u3002(\u56f36.input-cache \u30d6\u30ed\u30c3\u30af\u56f3 \u53c2\u7167\uff09 \u56f36. input-cache \u30d6\u30ed\u30c3\u30af\u56f3 \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 \u56f37. Np \u5206\u5272 \u4e26\u5217\u5316\u306e\u30a2\u30c9\u30ec\u30b9\u5206\u5272\u306f\u3001\u56f37\u306b\u793a\u3059\u3088\u3046\u306b\u3001output Tensor \u306e W x H \u3092 Np \u5206\u5272\u3059\u308b\u3002C \u3092\u5171\u901a\u306b\u3059\u308b\u3053\u3068\u3067\u3001filter, bias, quant \u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u304c\uff11\u7cfb\u7d71\u3067\u3059\u3080\u3002 \u305f\u3060\u3057\u3001W x H < Np \u306e\u3068\u304d\u306f\u4e26\u5217\u6570\u306f W x H \u306b\u5236\u9650\u3055\u308c\u308b\u3002 \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u95a2\u6570\u304b\u3089\u6e21\u3055\u308c\u308b\u6f14\u7b97\u30d1\u30e9\u30e1\u30fc\u30bf\u306f\u3001M_AXI_HPM0_FPD \u30dd\u30fc\u30c8 axi-apb \u30d6\u30ea\u30c3\u30b8\u3092\u4ecb\u3057\u3001\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u5236\u5fa1\u7528 RISC-V CPU \u306b\u6e21\u3055\u308c\u308b\u3002 Np\u500b\u4e26\u5217\u306e input/output \u305d\u308c\u305e\u308c\u306b\u7570\u306a\u308b\u30a2\u30c9\u30ec\u30b9\u767a\u751f\u3092\u884c\u3046\u305f\u3081\u3001CPU \u306f adrgen \u30d6\u30ed\u30c3\u30af\u306b Np\u7a2e\u985e\u306e\u30a2\u30c9\u30ec\u30b9\u3092\u8a08\u7b97\u3057\u3001\u8a2d\u5b9a\u3092\u884c\u3046\u3002 \u4e26\u5217\u306b\u5b9f\u88c5\u3059\u308b\u30a2\u30c9\u30ec\u30b9\u767a\u751f\u56de\u8def\u3092\u3067\u304d\u308b\u3060\u3051\u7c21\u5358\u5316\u3057\u3066\u30cf\u30fc\u30c9\u898f\u6a21\u3092\u6291\u3048\u308b\u305f\u3081\u306b\u3001CPU \u306b\u30a2\u30c9\u30ec\u30b9\u8a08\u7b97\u3092\u5206\u62c5\u3059\u308b\u3088\u3046\u306b\u3057\u305f\u3002\u307e\u305f\u3001\u3053\u306e CPU \u306b\u306f\u30b7\u30ea\u30a2\u30eb\u30bf\u30fc\u30df\u30ca\u30eb\u3092\u63a5\u7d9a\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u3001\u30c7\u30d0\u30c3\u30b0\u304a\u3088\u3073\u5b9f\u884c\u6642\u9593\u306e\u89b3\u6e2c\u306a\u3069\u306b\u3082\u6d3b\u7528\u3057\u305f\u3002","title":"FPGA\u306b\u5b9f\u88c5\u3057\u305f\u30cf\u30fc\u30c9\u30a6\u30a8\u30a2\u69cb\u6210"},{"location":"index.html#fpga_1","text":"\u4f5c\u6210\u3057\u305f RTL module \u3092 Vivado \u306e Block Design \u30c4\u30fc\u30eb\u306b\u8aad\u307f\u8fbc\u3093\u3067 Zynq \u3068\u63a5\u7d9a\u3057\u305f\u3002 (\u56f38. Block Design\u3000\u8272\u4ed8\u304d\u306e\u30d6\u30ed\u30c3\u30af\u304cRTL\u30d6\u30ed\u30c3\u30af) Np \u3001\u30ad\u30e3\u30c3\u30b7\u30e5\u30b5\u30a4\u30ba\u3001\u30af\u30ed\u30c3\u30af\u5468\u6ce2\u6570\u306a\u3069\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u5909\u3048\u3066\u8ad6\u7406\u5408\u6210\u3092\u7e70\u308a\u8fd4\u3057\u3001\u30a8\u30ea\u30a2\u53ca\u3073\u30bf\u30a4\u30df\u30f3\u30b0\u304c MET \u3067\u304d\u308b\u3088\u3046\u306b RTL \u8a18\u8ff0\u306b\u30d5\u30a3\u30fc\u30c9\u30d0\u30c3\u30af\u3057\u305f\u3002 \u56f38. Block Design \u56f39 \u306f\u6700\u7d42\u7684\u306a FPGA \u306e\u30ea\u30bd\u30fc\u30b9\u4f7f\u7528\u7387\u3067\u3042\u308b\u3002 \u3000 \u4e26\u5217\u6570 Np = 32 (MAC 128 \u4e26\u5217) \u3000 \u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u30af\u30ed\u30c3\u30af\u5468\u6ce2\u6570 = 187 MHz \u3000 RISC-V \u30af\u30ed\u30c3\u30af\u5468\u6ce2\u6570 = 100MHz BRAM \u304c 100% \u8fd1\u304f\u306b\u306a\u3063\u3066\u304a\u308a\u3001\u3053\u308c\u4ee5\u4e0a\u306e\u4e26\u5217\u6570\u5897\u52a0\u306f\u96e3\u3057\u3044\u3002\u307e\u305f\u4f7f\u7528\u7387\u304c\u4e0a\u304c\u308b\u306b\u5f93\u3063\u3066\u30bf\u30a4\u30df\u30f3\u30b0\u304c\u53b3\u3057\u304f\u306a\u308a\u3001\u30af\u30ed\u30c3\u30af\u5468\u6ce2\u6570\u3092\u4e0a\u3052\u3089\u308c\u306a\u3044\u3002 \u4e00\u65b9\u3067 LUT / DSP \u306b\u306f\u307e\u3060\u4f59\u88d5\u304c\u3042\u308a\u3001FPGA\u30ea\u30bd\u30fc\u30b9\u3092\u6700\u5927\u9650\u306b\u6d3b\u7528\u3059\u308b\u306b\u306f\u69cb\u9020\u306e\u898b\u76f4\u3057\u304c\u5fc5\u8981\u3067\u3042\u308b\u3002 \u56f39. Utilization","title":"\u8ad6\u7406\u5408\u6210\u3001FPGA \u5b9f\u88c5"},{"location":"index.html#_5","text":"\u4eca\u56de\u3001\u63a8\u8ad6\u306e\u5b9f\u884c\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f python \u3067\u4f5c\u6210\u3057\u305f\u3002 \u30e9\u30a4\u30d6\u30e9\u30ea tflite_runtime ^8 \u3092\u7528\u3044\u308b\u3002(KV260 \u7528\u306b tensorflow \u306e\u30bd\u30fc\u30b9\u30c4\u30ea\u30fc\u3067 cross build \u3059\u308b\u5fc5\u8981\u304c\u3042\u3063\u305f) \u65b0\u305f\u306b\u4f5c\u6210\u3057\u305f delegate \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306f\u3001\u30c0\u30a4\u30ca\u30df\u30c3\u30af\u30ea\u30f3\u30af\u30e9\u30a4\u30d6\u30e9\u30ea(dummy_external_delegate.so)\u3068\u3057\u3066 tflite_runtime \u3068\u30ea\u30f3\u30af\u3059\u308b\u3053\u3068\u3067\u5b9f\u884c\u306e delegate \u304c\u884c\u308f\u308c\u308b\u3002 tflite_runtime \u306e python \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3067\u306f interpreter \u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u6642\u306b dummy_external_delegate.so \u3092\u6307\u5b9a\u3057\u3066\u30ea\u30f3\u30af\u3059\u308b\u3060\u3051\u3067\u3042\u308b\u3002 ^8 tflite_runtime import tflite_runtime.interpreter as tflite # Instantiate interpreter interpreter = tflite . Interpreter ( model_path = model , experimental_delegates = [ tflite . load_delegate ( \u3000\u3000\u3000\u3000\u3000\u3000\u3000 '{path-to}/dummy_external_delegate.so.1' )] ) interpreter . allocate_tensors () # Get input and output tensors. input_details = interpreter . get_input_details () output_details = interpreter . get_output_details () : # preproc bev_image = preproc . preproc ( frame ) # lider data -> BEV image # set image interpreter . set_tensor ( input_details [ 0 ][ 'index' ], np . uint8 ( bev_image )) # Invoke interpreter . invoke () # Output inference result heatmap = interpreter . get_tensor ( output_details [ 0 ][ 'index' ])[ 0 ] cen_offset = interpreter . get_tensor ( output_details [ 1 ][ 'index' ])[ 0 ] # postproc det = postproc . postproc ( heatmap , cen_offset ) :","title":"\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3"},{"location":"index.html#risc-v","text":"\u4ee5\u4e0b\u3001\u63a8\u8ad6\u5b9f\u884c\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u3067\u3042\u308b lider data \u3092 file \u304b\u3089\u8aad\u307f\u8fbc\u307f\u3001python C API \u3092\u4ecb\u3057\u3066 preproc module \u306b\u6e21\u3059 preproc module \u306f lider data \u3092 CMA \u9818\u57df\u306b\u30b3\u30d4\u30fc\u3057\u3001RISC-V \u3092 kick \u3059\u308b RISC-V \u306f lider data \u304b\u3089 BEV \u753b\u50cf\u3078\u306e\u5909\u63db\u51e6\u7406\u3092\u884c\u3046 1 frame \u524d\u306e preproc \u3067\u751f\u6210\u3055\u308c\u305f BEV \u753b\u50cf\u3092 TFlite interpreter \u306b set_tensor() \u3057\u3066 invoke() \u3059\u308b \u63a8\u8ad6\u7d50\u679c\u306e heatmap \u3068 center-offset \u304b\u3089\u7269\u4f53\u4f4d\u7f6e\u3092\u8a08\u7b97\u3057\u3001json \u306b\u51fa\u529b\u3059\u308b \u51e6\u7406 3. \u3068\u51e6\u7406 4. \u304c\u4e26\u5217\u306b\u884c\u308f\u308c\u308b\u3002 RISC-V \u3067\u306f\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u306e\u5236\u5fa1\u306f\u5272\u308a\u8fbc\u307f\u51e6\u7406\u306b\u3088\u3063\u3066\u884c\u308f\u308c\u3001preproc \u306e BEV\u753b\u50cf\u751f\u6210\u51e6\u7406\u3068\u4e26\u5217\u306b\u5b9f\u884c\u3055\u308c\u308b\u3002 \u56f310. \u63a8\u8ad6\u5b9f\u884c\u30a2\u30d7\u30ea\u30b7\u30fc\u30b1\u30f3\u30b9","title":"RISC-V \u3068\u63a8\u8ad6\u5b9f\u884c\u30a2\u30d7\u30ea\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u3002"},{"location":"index.html#_6","text":"","title":"\u5b9f\u884c\u7d50\u679c"},{"location":"index.html#_7","text":"\u63a8\u8ad6\u6642\u9593\u306f\u3001PS \u306e CPU \u3068 FPGA/RISC-V \u3067\u5206\u62c5\u3055\u308c\u3066\u304a\u308a\u3001FPGA\u306e\u5b9f\u884c\u6642\u9593\u306f FPGA\u5185\u306b\u5b9f\u88c5\u3057\u305f\u30ab\u30a6\u30f3\u30bf\u3067\u6e2c\u5b9a\u3057\u305f\u3002 \u56f311 \u306b\u7d50\u679c\u3092\u793a\u3059\u3002 \u56f311. \u63a8\u8ad6\u51e6\u7406\u6642\u9593 \u30b0\u30e9\u30d5\u306e Conv(\u9ec4\u8272) \u90e8\u5206\u3001\u7573\u307f\u8fbc\u307f\u6f14\u7b97\u305d\u306e\u3082\u306e\u306e\u5b9f\u884c\u6642\u9593\u304c\u652f\u914d\u7684\u3067\u3042\u308b\u3002 RISC-V \u306e preproc \u306f\u4e26\u884c\u3057\u3066\u51e6\u7406\u3055\u308c\u3001\u8868\u306b\u306f\u73fe\u308c\u306a\u3044\u3002","title":"\u63a8\u8ad6\u51e6\u7406\u6642\u9593\u8a73\u7d30"},{"location":"index.html#_8","text":"TensorFlow Lite \u306e delegate \u6a5f\u69cb\u3092\u7528\u3044\u305f FPGA \u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u3092\u958b\u767a\u3057\u3001\u8ab2\u984c\u306b\u5bfe\u3059\u308b\u52d5\u4f5c\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u305f\u3002 \u3053\u306e\u65b9\u5f0f\u306f\u3001\u65e2\u5b58\u306e TFlite \u306e\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3092\u5909\u3048\u308b\u3053\u3068\u306a\u304f\u3001\u305d\u306e\u307e\u307e\u4f7f\u3048\u308b\u7279\u5fb4\u304c\u3042\u308b\u3002 \u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u306f output \u30c1\u30e3\u30f3\u30cd\u30eb\u306e 4\u4e26\u5217\u5316\u3092\u5b9f\u88c5\u3057\u3001MAC\u306e\u4e26\u5217\u6570\u3092 128 \u4e26\u5217\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u305f\u3002 \u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u3067 filter \u4fc2\u6570\u306e\u4e26\u3079\u66ff\u3048\u3092\u884c\u3046\u3053\u3068\u3067\u30cf\u30fc\u30c9\u30a6\u30a8\u30a2\u306e\u8907\u96d1\u5316\u3092\u56de\u907f\u3057\u305f\u3002 RISC-V (rv32emc) \u3092 RTL \u3067\u5b9f\u88c5\u3057\u3001FPGA\u306b\u7d44\u307f\u8fbc\u3093\u3067\u3001\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u5236\u5fa1\u3068 Lider \u30c7\u30fc\u30bf\u306e\u524d\u51e6\u7406\u306b\u7528\u3044\u305f\u3002 Zfinx \u4ed5\u69d8\u306e fpu \u3092\u65b0\u305f\u306b\u958b\u767a\u3057\u3066\u7d44\u307f\u8fbc\u307f\u3001Lider data \u306e\u51e6\u7406\u306b\u6d3b\u7528\u3057\u305f\u3002","title":"\u307e\u3068\u3081\u3001\u4eca\u5f8c\u306e\u8ab2\u984c"},{"location":"index.html#_9","text":"CPU\u3067\u306e\u63a8\u8ad6\u5b9f\u884c\u306b\u5bfe\u3057\u3001FPGA \u3067\u306e\u5b9f\u884c\u3067\u63a8\u8ad6\u7cbe\u5ea6\u304c\u82e5\u5e72\u4f4e\u4e0b\u3059\u308b\u3053\u3068\u304c\u308f\u304b\u3063\u3066\u3044\u308b\u3002 acc \u56de\u8def\u306e\u4e38\u3081\u306b\u3064\u3044\u3066\u8a73\u7d30\u306b\u8abf\u67fb\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002 \u52d5\u4f5c\u901f\u5ea6\u306f CPU 100MHz\u3001\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf 187MHz \u304c\u9650\u754c\u3067\u3042\u3063\u305f\u3002\u30af\u30ea\u30c1\u30ab\u30eb\u30d1\u30b9\u3092\u8abf\u67fb\u3057\u3001\u8ad6\u7406\u6bb5\u6570\u3092\u6e1b\u3089\u3059\u5fc5\u8981\u304c\u3042\u308b\u3002 \u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u306f pipeline \u5316\u306e\u4f59\u5730\u304c\u3042\u308b\u3002CPU \u306f compress \u547d\u4ee4\u5bfe\u5fdc\u304c\u901f\u5ea6\u4f4e\u4e0b\u306e\u4e00\u56e0\u3067\u3042\u308b\u306e\u3067\u4ed5\u69d8\u5909\u66f4\u304c\u6709\u52b9\u304b\u3082\u3057\u308c\u306a\u3044\u3002 \u3053\u308c\u307e\u3067\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30bf\u306b delegate \u3059\u308b\u6f14\u7b97\u3092 Conv2D \u306b\u9650\u3063\u3066\u304d\u305f\u304c\u3001\u30cf\u30fc\u30c9\u898f\u6a21\u306e\u5897\u5927\u3092\u6291\u3048\u3064\u3064\u5bfe\u5fdc\u3067\u304d\u308b\u6f14\u7b97\u3092\u5897\u3084\u3059\u3053\u3068\u3092\u8003\u3048\u3066\u307f\u305f\u3044\u3002","title":"\u4eca\u5f8c\u306e\u8ab2\u984c"}]}